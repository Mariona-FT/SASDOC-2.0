{% extends 'base-template/base.html' %}

{% block title %}Tipus de Professor{% endblock %}

{% block content %}

<h2>{% if form.instance.pk %}Actualitzar Tipus de Professor{% else %}Crear Tipus de Professor{% endif %}</h2>

<!-- Display success, warning, or error messages -->
{% if messages %}
    <div class="messages">
        {% for message in messages %}
            <div class="{% if message.tags %}alert alert-{{ message.tags }}{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    </div>
{% endif %}

<!-- Form for creating/updating type of professor -->
<form method="post" class="mb-4">
    {% csrf_token %}
    {% if form.instance.pk %}
        <input type="hidden" name="idTypeProfessor" value="{{ form.instance.pk }}">
    {% endif %}
    <div class="mb-3">
        {{ form.as_p }}  <!-- This will use the custom labels -->
    </div>
    <button type="submit" class="btn btn-primary">{% if form.instance.pk %}Actualitzar{% else %}Crear{% endif %} Tipus de Professor</button>
</form>

<hr>

<!-- List of all types of professors -->
<h3>Llista de Tipus de Professors</h3>
<table class="table table-striped">
    <thead>
        <tr>
            <th>Nom</th>
            <th>Temps Completo</th>
            <th>Permanent</th>
            <th>Comentaris</th>
            <th>Actiu</th>
            <th>Accions</th>
        </tr>
    </thead>
    <tbody>
        {% if type_professors %}
            {% for type_professor in type_professors %}
                <tr>
                    <td>{{ type_professor.Name }}</td>
                    <td>{{ type_professor.isFullTime|yesno:"Sí,No" }}</td>
                    <td>{{ type_professor.isPermanent|yesno:"Sí,No" }}</td>
                    <td>{{ type_professor.Comment}}</td>
                    <td>{{ type_professor.isActive|yesno:"Sí,No" }}</td>
                    <td>
                        <!-- Edit button -->
                        <a href="?edit={{ type_professor.pk }}" class="btn btn-warning btn-sm">Editar</a>

                        <!-- Delete form with JavaScript confirmation -->
                        <form method="post" action="{% url 'type_professor_crud' %}" style="display:inline;" onsubmit="return confirmDelete('{{ type_professor.Name }}');">
                            {% csrf_token %}
                            <input type="hidden" name="confirm_delete" value="{{ type_professor.pk }}">
                            <button type="submit" class="btn btn-danger btn-sm">Eliminar</button>
                        </form>
                    </td>
                </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="5" class="text-center">Cap tipus de professor entrat.</td>
            </tr>        
        {% endif %}
    </tbody>
</table>

<!-- JavaScript function for confirmation -->
<script>
    function confirmDelete(fieldName) {
        return confirm("Estàs segur que vols eliminar aquest tipus de professor: " + fieldName + "?");
    }
</script>

{% endblock %}
